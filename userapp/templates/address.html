{% extends 'base.html' %}

{% block title %}
    åœ°å€ç®¡ç†
{% endblock %}

{% block main %}
    <div class="address">

        <div class="addressbody" >
            <br />
            <div class="addressbodywel">
                <a href="/user/main/">æ¬¢è¿å›æ¥ï¼š[{{ user.uname }}]</a>
            </div>
            <div class="addressbodyleft">
                <img src="/static/photo.png" width="100px" style="margin-left: 60px;">
                <p>[enen123123]</p>
                <a href="/user/login/">[é€€å‡ºç™»å½•]</a>
                <hr />
                <a href="/cart/queryall/">æˆ‘çš„è´­ç‰©è½¦</a><br />
                <a >åœ°å€ç®¡ç†</a><br />
                <a href="/good/">è¿”å›é¦–é¡µ</a><br />
            </div>
            <div class="addressbodyright">
                <div class="addressbodyrighttop">
                    <h3>åœ°å€ç®¡ç†(è¯·è‡³å°‘è®¾ç½®ä¸€ä¸ªåœ°å€)ï¼š</h3>
                    <div class="addressbodyrighttop1">
                        <ul class="ul1">
                            {% for addrobj in addrlist %}
                                <li class="li1">
                                    {% if addrobj.isdefault == 1 %}
                                        <p style="background-color:lightcoral;width: 90px; float: right; margin-right: 20px; ">é»˜è®¤åœ°å€âœ¨</p>
                                    {% endif %}
                                    <p>ğŸ™{{ addrobj.aname }}ğŸ“±{{ addrobj.aphone}}</p>
                                        <p>ğŸ“åœ°å€â€ï¼š{{ addrobj.addr }}</p>
                                        <a href="/user/deleteaddr/{{ addrobj.id }}" style="color: orange">&nbsp;åˆ é™¤</a>
                                </li>
                            {% endfor %}
                        </ul>

                        <p></p>
                    </div>
                </div>
                <div class="addressbodyrightbottom">
                    <h3>æ–°å¢åœ°å€ï¼š</h3>
                    <div class="addressbodyrightbottom1">
                        <form id="frm" action="/user/address/" method="post" onsubmit="alert(hello)" >
                            {% csrf_token %}
                            <table>
                            <tr>
                                <td>æ”¶è´§äºº</td>
                                <td><input type="text" name="aname" ></td>
                            </tr><br>
                            <tr>
                                <td>æ‰‹æœºå·ç </td>
                                <td><input type="text" name="aphone" ></td>
                            </tr>
                            <tr>
                                <td>æ‰€åœ¨åœ°</td>
                                <td>
                                    <select name="" id="province" onchange="loadcity()">
{#											<option value="">è¥¿å®‰å¸‚</option>#}
                                    </select>
                                    <select name="" id="city" onchange="loadtown()">
{#											<option value="">è¥¿å®‰å¸‚</option>#}</select>
                                    <select name="" id="town">
{#											<option value="">è¥¿å®‰å¸‚</option>#}
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>è¯¦ç»†åœ°å€</td>
{#									<td><input type="text" name="addr" onfocus="fillcontent(this)" style="height: 60px;" placeholder="100å­—ä»¥å†…è¯¦ç»†ä¿¡æ¯" ></td>#}
                                <td>
                                    <textarea name="addr" onfocus="fillcontent(this)" cols="30" rows="10" style="height: 60px;width: auto" ></textarea>
                                </td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>
                                    &emsp;
                                    <input type="submit" value="ä¿å­˜" onclick="$('#frm').submit()" >
                                    <input type="button" value="å–æ¶ˆ">
                                </td>

                            </tr>
                        </table>
                        </form>
                    </div>
                </div>
            </div>

        </div>

    </div>
{% endblock %}

{% block footerjs %}
    <script>
        $(function (){
            loadprovince();
        })
        function loadprovince(){
            loadarea(0,'province',loadcity);
        }
        function loadcity(){
            loadarea($('#province').val(),'city',loadtown);
        }
        function loadtown(){
            loadarea($('#city').val(),'town',);
        }
        function loadarea(pid,selectid,nextload){
            {#æ¸…ç©ºå½“å‰ä¸‹æ‹‰æ¡†å†…å®¹#}
            $('#'+selectid).empty();
            {#é€šè¿‡ajaxè·å–è¯·æ±‚åœ°å€#}
            $.get('/user/loadaddr/',{pid:pid},function(result){
                console.log(result.jarealist)
                {#è½¬åŒ–ä¸ºæ•°ç»„#}
                var arealist=JSON.parse(result.jarealist);
                //éå†
                for (var i=0;i<arealist.length;i++){
                    var area=arealist[i];
                    //å°†æ•°æ®æ·»åŠ åˆ°selectæ ‡ç­¾å†…éƒ¨  pkå¯¹åº”ä¸»é”®ï¼Œå¯åœ¨ç½‘é¡µæŸ¥çœ‹
                    $('#'+selectid).append('<option value="'+area.pk+'">'+area.fields.areaname+'</option>');
                }
                if (nextload!=null){
                    nextload()
                }
            })
        }
        function fillcontent(txt){
            //è·å¾—ç”¨æˆ·é€‰æ‹©çš„çœå¸‚å¿
            var province=$('#province>option:selected').text();
            var city=$('#city>option:selected').text();
            var town=$('#town>option:selected').text();

            //å°†ä¿¡æ¯å¡«å…¥
            var txtall=province+'-'+city+'-'+town+':';
            $(txt).val(txtall);

        }
    </script>
{% endblock %}


